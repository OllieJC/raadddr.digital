<!DOCTYPE html>
<html lang="en-GB">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RAADDDR — Digital Lifecycle</title>
  <meta name="description" content="RAADDDR: A complete loop for resilient digital technology, products and services.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* --- CSS Variables & Theming --- */
    :root {
      /* Dark Mode (Default) - HIGH CONTRAST */
      --bg-color: #0f1b2d;
      --bg-gradient: radial-gradient(circle at 15% 50%, rgba(93, 225, 230, 0.15), transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(139, 92, 246, 0.15), transparent 25%);

      /* Text Colors: Crisp White */
      --text-main: #FFFFFF;
      --text-muted: #E5E5E5;

      --accent: #5de1e6;
      --card-bg: rgba(255, 255, 255, 0.03);
      --card-border: rgba(255, 255, 255, 0.15);
      --card-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);

      --chip-bg: rgba(255, 255, 255, 0.08);
      --chip-bg-hover: rgba(255, 255, 255, 0.15);
      --chip-border: rgba(255, 255, 255, 0.2);

      --glass-blur: blur(16px);
      --transition-speed: 0.3s;
    }

    [data-theme="light"] {
      /* Light Mode Overrides - HIGH CONTRAST */
      --bg-color: #f0f4f8;
      --bg-gradient: radial-gradient(circle at 15% 50%, rgba(93, 225, 230, 0.4), transparent 30%),
        radial-gradient(circle at 85% 30%, rgba(139, 92, 246, 0.25), transparent 30%);

      /* Text Colors: Crisp Black */
      --text-main: #000000;
      --text-muted: #1A1A1A;

      --accent: #067a96;

      --card-bg: rgba(255, 255, 255, 0.75);
      --card-border: rgba(0, 0, 0, 0.1);
      --card-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);

      --chip-bg: rgba(255, 255, 255, 0.8);
      --chip-bg-hover: #FFFFFF;
      --chip-border: rgba(0, 0, 0, 0.1);
    }

    /* --- Reset & Base --- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Space Grotesk', system-ui, sans-serif;
      background-color: var(--bg-color);
      background-image: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 1rem;
      transition: background var(--transition-speed) ease, color var(--transition-speed) ease;
    }

    /* --- Layout --- */
    .wrapper {
      width: 100%;
      max-width: 680px;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      /* Gap between card and footer */
    }

    /* --- Controls Header (Top Right) --- */
    .controls {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      align-self: stretch;
      width: 100%;
      flex-wrap: wrap;
    }

    .control-btn {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      color: var(--text-main);
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      backdrop-filter: var(--glass-blur);
      -webkit-backdrop-filter: var(--glass-blur);
      font-family: inherit;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .control-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
      border-color: var(--accent);
    }

    .control-text {
      font-size: 0.85rem;
      font-weight: 600;
    }

    /* --- Main Card --- */
    .glass-card {
      background: var(--card-bg);
      backdrop-filter: var(--glass-blur);
      -webkit-backdrop-filter: var(--glass-blur);
      border: 1px solid var(--card-border);
      border-radius: 24px;
      padding: 3rem 2rem;
      box-shadow: var(--card-shadow);
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: border-color 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
    }

    /* Glow Effect inside card */
    .glow-spot {
      position: absolute;
      top: -50px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 200px;
      background: var(--accent);
      filter: blur(80px);
      opacity: 0.15;
      pointer-events: none;
      border-radius: 50%;
    }

    /* --- Logo Styles --- */
    .logo-container {
      margin-bottom: 24px;
      display: flex;
      justify-content: center;
    }

    .logo-svg {
      width: 80px;
      height: 80px;
      fill: var(--accent);
      filter: drop-shadow(0 0 10px rgba(93, 225, 230, 0.3));
      animation: spin-slow 20s linear infinite;
    }

    @keyframes spin-slow {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .logo-svg {
        animation: none !important;
      }

      .grid-item {
        transition: none !important;
      }

      .grid-item:hover,
      .grid-item:active {
        transform: none !important;
      }

      .modal-overlay,
      .modal-content {
        transition: none !important;
      }
    }

    h1 {
      font-size: clamp(2rem, 5vw, 3.5rem);
      line-height: 1.1;
      margin-bottom: 1rem;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .description {
      font-size: 1.125rem;
      color: var(--text-muted);
      line-height: 1.6;
      margin-bottom: 2.5rem;
      max-width: 540px;
      margin-left: auto;
      margin-right: auto;
      font-weight: 400;
    }

    /* --- The Grid (2 Columns) --- */
    .acronym-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 0;
      /* Removing bottom margin as footer is external now */
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .grid-item {
      background: var(--chip-bg);
      border: 1px solid var(--chip-border);
      padding: 16px 12px;
      border-radius: 16px;
      color: var(--text-main);
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      white-space: nowrap;
    }

    .grid-item:hover {
      transform: translateY(-4px);
      background: var(--chip-bg-hover);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .grid-item:active {
      transform: translateY(-1px);
    }

    .grid-item:last-child {
      grid-column: span 2;
      width: 50%;
      margin: 0 auto;
    }

    /* Letter highlight */
    .grid-item .letter {
      color: var(--accent);
      font-weight: 800;
      font-size: 1.1em;
      margin-right: 1px;
    }

    .grid-item em {
      font-style: italic;
      opacity: 1;
      margin-right: 4px;
      font-family: inherit;
      font-weight: 400;
    }

    /* --- Modals (General) --- */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1000;
    }

    .modal-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .modal-content {
      background: var(--bg-color);
      width: 90%;
      max-width: 500px;
      /* Slightly wider for roles */
      padding: 2.5rem 2rem;
      border-radius: 20px;
      border: 2px solid var(--accent);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      transform: scale(0.95);
      transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      text-align: left;
      position: relative;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: transparent;
      border: none;
      color: var(--text-main);
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
      z-index: 10;
    }

    .modal-close:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    /* --- Detail Modal Specifics --- */
    .modal-header {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 0.5rem;
      color: var(--accent);
    }

    .modal-big-letter {
      font-size: 3rem;
      font-weight: 700;
      line-height: 1;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-main);
    }

    .modal-title em {
      font-family: inherit;
      font-style: italic;
      font-weight: 400;
      margin-right: 4px;
    }

    /* Role Pills Container */
    .modal-roles {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 1.5rem;
    }

    .role-pill {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 20px;
      background: rgba(93, 225, 230, 0.1);
      color: var(--accent);
      border: 1px solid rgba(93, 225, 230, 0.2);
      font-weight: 600;
      white-space: nowrap;
    }

    .modal-desc {
      color: var(--text-muted);
      line-height: 1.6;
      margin-bottom: 0;
      font-size: 1.1rem;
      font-weight: 400;
    }

    /* --- Footer (CC0) --- */
    .site-footer {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.8rem;
      padding: 1rem;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      backdrop-filter: var(--glass-blur);
      -webkit-backdrop-filter: var(--glass-blur);
      border-radius: 16px;
    }

    .site-footer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
      margin: 0 4px;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    /* --- Language List --- */
    .lang-list {
      display: grid;
      gap: 12px;
      margin-top: 1rem;
    }

    .lang-btn {
      background: var(--chip-bg);
      border: 1px solid var(--chip-border);
      padding: 16px;
      border-radius: 12px;
      color: var(--text-main);
      text-align: left;
      cursor: pointer;
      font-family: inherit;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.2s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .lang-btn:hover {
      background: var(--chip-bg-hover);
      border-color: var(--accent);
    }

    .lang-btn.active {
      border-color: var(--accent);
      background: rgba(93, 225, 230, 0.15);
    }

    .lang-btn .check {
      opacity: 0;
      color: var(--accent);
    }

    .lang-btn.active .check {
      opacity: 1;
    }

    /* --- Icons --- */
    .icon {
      width: 18px;
      height: 18px;
      fill: currentColor;
      flex-shrink: 0;
    }

    .icon-lg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    @media (max-width: 600px) {
      .controls {
        width: 100%;
        justify-content: center;
        align-self: center;
      }

      .glass-card {
        padding: 2rem 1.5rem;
      }

      .grid-item:last-child {
        width: 100%;
      }
    }

    @media (max-width: 350px) {
      h1 {
        font-size: 2rem;
      }

      .acronym-grid {
        grid-template-columns: 1fr;
      }

      .grid-item:last-child {
        grid-column: auto;
        width: 100%;
        margin: 0;
      }
    }
  </style>
</head>

<body>

  <!-- DETAIL Modal -->
  <div id="detailModal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close" id="closeDetailModal" aria-label="Close details">
        <svg class="icon-lg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
      </button>
      <div class="modal-header">
        <span class="modal-big-letter" id="mLetter"></span>
        <span class="modal-title" id="mTitle"></span>
      </div>
      <!-- Roles Container -->
      <div class="modal-roles" id="mRoles"></div>

      <p class="modal-desc" id="mDesc"></p>
    </div>
  </div>

  <!-- LANGUAGE Modal -->
  <div id="langModal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close" id="closeLangModal" aria-label="Close language selection">
        <svg class="icon-lg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
      </button>
      <h2 id="langModalTitle" data-i18n="langModalTitle" style="margin-bottom: 0.5rem; font-size: 1.5rem; font-weight: 700;">Select Language</h2>
      <p id="langModalDesc" data-i18n="langModalDesc" style="color: var(--text-muted); margin-bottom: 1.5rem; font-weight: 400;">Choose your preferred interface language.</p>
      <div class="lang-list" id="langList">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>

  <div class="wrapper">
    <!-- Controls: Language & Theme -->
    <header class="controls" aria-label="Site settings">
      <button class="control-btn" id="langBtn" aria-label="Change Language">
        <svg class="icon" viewBox="0 0 24 24">
          <path d="M12.87 15.07l-2.54-2.51.03-.03A17.52 17.52 0 0014.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
        <span class="control-text" id="langLabel">English</span>
        <svg class="icon" style="width:14px; height:14px; opacity:0.7;" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
      </button>
      <button class="control-btn" id="themeToggle" aria-label="Toggle Dark Mode">
        <svg class="icon" id="themeIcon" viewBox="0 0 24 24">
          <path d="M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-5.4-5.4c0-1.81.73-3.44 1.91-4.64C12.92 3.04 12.46 3 12 3zm0-2a11 11 0 0111 11 11 11 0 01-11 11A11 11 0 011 12 11 11 0 0112 1z"/></svg>
        <span class="control-text" id="themeLabel">Dark Mode</span>
      </button>
    </header>

    <main>
      <article class="glass-card">
        <div class="logo-container">
          <!-- Custom SVG Logo: 7 elements in a loop -->
          <svg viewBox="0 0 100 100" class="logo-svg" aria-label="RAADDDR Logo">
            <defs>
              <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:var(--accent);stop-opacity:1" />
                <stop offset="100%" style="stop-color:var(--text-main);stop-opacity:0.5" />
              </linearGradient>
            </defs>
            <!-- 7 distinct geometric pills arranged in a dynamic spiral -->
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.4" transform="rotate(0 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.5" transform="rotate(51.4 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.6" transform="rotate(102.8 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.7" transform="rotate(154.2 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.8" transform="rotate(205.6 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="0.9" transform="rotate(257 50 50)" />
            <rect x="46" y="5" width="8" height="20" rx="4" opacity="1.0" transform="rotate(308.4 50 50)" />
          </svg>
        </div>

        <div class="glow-spot"></div>

        <h1 data-i18n="title">Digital the RAADDDR way</h1>

        <p class="description" data-i18n="description">
          Orchestrating the digital lifecycle in continuous, adaptive loops - from the first spark of discovery to retirement or replacement.
        </p>

        <section class="acronym-grid" aria-label="RAADDDR Principles">
          <!-- Content populated by JS -->
        </section>
      </article>
    </main>

    <footer class="site-footer">
      <span data-i18n="footerLegal">This work is published for the Public Domain from the United Kingdom.</span><br><br>
      <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0 1.0 Universal</a> •
      <a href="https://unlicense.org/" target="_blank" rel="noopener noreferrer">The Unlicense</a>
    </footer>
  </div>

  <script>
    // --- Configuration & Data ---

    // Define available languages
    const languages = [
      { code: 'en-GB', name: 'English (UK)' },
      { code: 'en-US', name: 'English (US)' },
      { code: 'fr', name: 'Français' }
    ];

    // Base Translation Objects
    const translations = {
      'fr': {
        title: "Le numérique façon RAADDDR",
        description: "Orchestrer le cycle de vie numérique en boucles continues et adaptatives - de la première étincelle de découverte jusqu'au remplacement ou à la retraite.",
        themeLabelDark: "Mode sombre",
        themeLabelLight: "Mode clair",
        langModalTitle: "Choisir la langue",
        langModalDesc: "Sélectionnez votre langue d'interface préférée.",
        footerLegal: "Cette œuvre est publiée dans le domaine public au Royaume-Uni.",
        items: [
          {
            letter: "R",
            label: "Recherche",
            prefix: "",
            roles: ["Chercheur·e en recherche utilisateur"],
            desc: "Planifier et mener des activités de recherche utilisateur pour aider les équipes à comprendre en profondeur les personnes qui utilisent les services gouvernementaux. Cette recherche informe la politique, la proposition, le service, le contenu et le design d'interaction pour que les services fonctionnent bien pour les utilisateurs et atteignent l'objectif politique."
          },
          {
            letter: "A",
            label: "Analyse",
            prefix: "",
            roles: ["Analyste métier", "Analyste de données", "Analyste performance"],
            desc: "Auditer les données et comprendre les processus métier pour garantir que les solutions technologiques s'alignent avec les objectifs stratégiques. Cela implique d'agréger des informations complexes de toute l'organisation pour éclairer la prise de décision."
          },
          {
            letter: "A",
            label: "Architecture",
            prefix: "",
            roles: ["Architecte technique", "Architecte données", "Architecte métier", "Architecte solution"],
            desc: "Développer une vue intégrée de l'entreprise et de ses systèmes. Les architectes conçoivent la structure et les relations entre les données, les applications et l'infrastructure pour garantir scalabilité, sécurité et alignement avec la stratégie."
          },
          {
            letter: "D",
            label: "Design",
            prefix: "Le",
            roles: ["Designer de service", "Designer d'interaction", "Designer de contenu", "Graphiste"],
            desc: "Concevoir des services complets de bout en bout qui répondent aux besoins des utilisateurs et aux objectifs politiques. Cela inclut la création d'interfaces intuitives, de contenu clair et de parcours utilisateurs fluides sur tous les canaux."
          },
          {
            letter: "D",
            label: "Développement",
            prefix: "",
            roles: ["Développeur logiciel", "Développeur front-end", "Développeur back-end", "Ingénieur DevOps"],
            desc: "Écrire, adapter, maintenir et soutenir un code de qualité professionnelle. Les développeurs construisent la solution technique, assurant qu'elle est robuste, testable et répond aux normes d'accessibilité et de sécurité."
          },
          {
            letter: "D",
            label: "Déploiement",
            prefix: "",
            roles: ["Responsable delivery / Responsable de livraison", "Chef de produit", "Responsable des mises en production"],
            desc: "Gérer le cycle de vie du produit et le pipeline de livraison. Il s'agit de livrer de la valeur aux utilisateurs de manière continue et fiable, en surmontant les obstacles et en favorisant une culture d'amélioration continue."
          },
          {
            letter: "R",
            label: "Run",
            prefix: "Le",
            roles: ["Ingénieur fiabilité (SRE)", "Exploitation informatique", "Centre de services / Service desk", "Responsable de service / Gestionnaire de services"],
            desc: "Assurer la fiabilité, la disponibilité et la performance des services en production. Cela implique le monitoring, la gestion des incidents et l'optimisation continue de l'infrastructure pour répondre aux besoins changeants."
          }
        ]
      },
      // British English serves as the Base for English
      'en-GB': {
        title: "Digital the RAADDDR way",
        description: "Orchestrating the digital lifecycle in continuous, adaptive loops - from the first spark of discovery to retirement or replacement.",
        themeLabelDark: "Dark Mode",
        themeLabelLight: "Light Mode",
        langModalTitle: "Select Language",
        langModalDesc: "Choose your preferred interface language.",
        footerLegal: "This work is published for the Public Domain from the United Kingdom.",
        items: [
          {
            letter: "R",
            label: "Research",
            prefix: "",
            roles: ["User Researcher"],
            desc: "Plan and carry out user research activities that help teams get a deep understanding of the people that use government services. This research informs policy, proposition, service, content, and interaction design so that services work well for users and achieve policy intent."
          },
          {
            letter: "A",
            label: "Analyse",
            prefix: "",
            roles: ["Business Analyst", "Data Analyst", "Performance Analyst"],
            desc: "Audit data and understand business processes to ensure technology solutions align with strategic goals. This involves aggregating and disaggregating complex information from across the organisation to inform decision-making."
          },
          {
            letter: "A",
            label: "Architect",
            prefix: "",
            roles: ["Technical Architect", "Data Architect", "Business Architect", "Solution Architect"],
            desc: "Develop an integrated view of an enterprise and its systems. Architects design the structure and relationships of data, applications, and infrastructure to ensure scalability, security, and alignment with strategy."
          },
          {
            letter: "D",
            label: "Design",
            prefix: "",
            roles: ["Service Designer", "Interaction Designer", "Content Designer", "Graphic Designer"],
            desc: "Design end-to-end services that work for users and meet policy goals. This encompasses creating intuitive interfaces, clear content, and seamless user journeys across all channels, transforming needs into tangible experiences."
          },
          {
            letter: "D",
            label: "Develop",
            prefix: "",
            roles: ["Software Developer", "Frontend Developer", "Backend Developer", "DevOps Engineer"],
            desc: "Write, adapt, maintain, and support high-quality code. Developers build the technical solution, ensuring it is robust, testable, and meets accessibility and security standards for modern digital products."
          },
          {
            letter: "D",
            label: "Deliver",
            prefix: "",
            roles: ["Delivery Manager", "Product Manager", "Release Manager"],
            desc: "Manage the product lifecycle and delivery pipeline. This focuses on shipping value to users continuously and reliably, removing blockers, and fostering a culture of continuous improvement and rapid feedback loops."
          },
          {
            letter: "R",
            label: "Run",
            prefix: "",
            roles: ["Site Reliability Engineer", "IT Operations", "Service Desk", "Service Manager"],
            desc: "Ensure the reliability, availability, and performance of services in production. This involves monitoring, incident management, and continuous optimization of infrastructure to meet evolving user and operational needs."
          }
        ]
      },
      // American English Overrides
      'en-US': {
        // description: Same as GB, so omitted to test fallback logic
        // title: Same as GB
        items: [
          {}, // R (Index 0) - Empty object means inherit from base
          {
            // A (Index 1) - Override Label
            label: "Analyze",
            // Desc can be inherited or overridden. If American spelling differs significantly in body text, include here.
            // For MVP simplicity, we override just the label for demonstration.
            roles: ["Business Analyst", "Data Analyst", "Performance Analyst"],
            desc: "Audit data and understand business processes to ensure technology solutions align with strategic goals. This involves aggregating and disaggregating complex information from across the organization to inform decision-making." // Organization (z)
          },
          {}, // A (Index 2)
          {}, // D (Index 3)
          {}, // D (Index 4)
          {}, // D (Index 5)
          {
            // R (Index 6)
            roles: ["Site Reliability Engineer", "IT Operations", "Service Desk", "Service Manager"],
            desc: "Ensure the reliability, availability, and performance of services in production. This involves monitoring, incident management, and continuous optimization of infrastructure to meet evolving user and operational needs." // Optimization (z)
          }
        ]
      }
    };

    // --- State Management ---

    // Auto-detect Language Function
    function detectLanguage() {
      // Check LocalStorage first
      const stored = localStorage.getItem('raadddr_lang');
      if (stored) return stored;

      // Check Browser Language
      const browserLang = navigator.language; // e.g., "en-US", "fr-FR", "en"

      // Check for exact match in our supported list
      if (languages.some(l => l.code === browserLang)) {
        return browserLang;
      }

      // Check for partial match (e.g. "fr-CA" -> "fr")
      const baseLang = browserLang.split('-')[0];
      if (languages.some(l => l.code === baseLang)) {
        return baseLang;
      }

      // Default to British English if nothing matches
      return 'en-GB';
    }

    const state = {
      lang: detectLanguage(),
      theme: localStorage.getItem('raadddr_theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
    };

    // --- DOM Elements ---
    const els = {
      html: document.documentElement,
      grid: document.querySelector('.acronym-grid'),

      // Language Controls
      langBtn: document.getElementById('langBtn'),
      langLabel: document.getElementById('langLabel'),
      langModal: document.getElementById('langModal'),
      langList: document.getElementById('langList'),
      closeLangModal: document.getElementById('closeLangModal'),

      // Theme Controls
      themeToggle: document.getElementById('themeToggle'),
      themeLabel: document.getElementById('themeLabel'),
      themeIcon: document.getElementById('themeIcon'),

      // Detail Modal
      detailModal: document.getElementById('detailModal'),
      closeDetailModal: document.getElementById('closeDetailModal'),
      mLetter: document.getElementById('mLetter'),
      mTitle: document.getElementById('mTitle'),
      mRoles: document.getElementById('mRoles'),
      mDesc: document.getElementById('mDesc'),

      i18nTargets: document.querySelectorAll('[data-i18n]')
    };

    // --- Core Functions ---

    // Helper: Get merged data for a specific language
    function getLocalizedData(langCode) {
      // If it's French, return French directly
      if (langCode === 'fr') return translations['fr'];

      // If it's GB, return GB directly
      if (langCode === 'en-GB') return translations['en-GB'];

      // If it's US (or other future English variants), merge with GB base
      if (langCode === 'en-US') {
        const base = translations['en-GB'];
        const override = translations['en-US'];

        // Deep merge logic simplified for this specific structure
        const merged = { ...base, ...override };

        // Merge Items Array specifically
        if (override.items) {
          merged.items = base.items.map((item, index) => {
            const overrideItem = override.items[index];
            // If override exists and has keys, merge it over base item
            if (overrideItem && Object.keys(overrideItem).length > 0) {
              return { ...item, ...overrideItem };
            }
            return item;
          });
        }
        return merged;
      }

      // Fallback
      return translations['en-GB'];
    }

    function updateContent() {
      const t = getLocalizedData(state.lang);
      const currentLangName = languages.find(l => l.code === state.lang).name;

      // Update simple text elements
      els.i18nTargets.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.textContent = t[key];
      });

      // Update Language Label in Header
      els.langLabel.textContent = currentLangName;

      // Update Theme Label based on current Lang + Theme
      updateThemeLabel(t);

      els.html.setAttribute('lang', state.lang);

      // Rebuild Grid
      els.grid.innerHTML = '';
      t.items.forEach((item, index) => {
        const btn = document.createElement('div');
        btn.className = 'grid-item';
        btn.setAttribute('role', 'button');
        btn.setAttribute('tabindex', '0');

        // Logic for "Le Design" -> <em>Le</em> <span class="letter">D</span>esign
        let html = '';
        if (item.prefix) {
          html += `<em>${item.prefix}</em>`;
        }
        html += `<span class="letter">${item.letter}</span>`;
        html += item.label.substring(1); // Rest of the word

        btn.innerHTML = html;

        // Add click listener for modal
        btn.addEventListener('click', () => openDetailModal(item));

        els.grid.appendChild(btn);
      });
    }

    function updateThemeLabel(t) {
      // Need to pass 't' because it changes based on lang
      if (!t) t = getLocalizedData(state.lang);
      els.themeLabel.textContent = state.theme === 'dark' ? t.themeLabelDark : t.themeLabelLight;
    }

    // --- Modal Logic ---

    // 1. Detail Modal
    function openDetailModal(item) {
      els.mLetter.textContent = item.letter;
      if (item.prefix) {
        els.mTitle.innerHTML = `<em>${item.prefix}</em> ${item.label}`;
      } else {
        els.mTitle.textContent = item.label;
      }

      // Populate Roles Pills
      els.mRoles.innerHTML = '';
      if (item.roles && item.roles.length > 0) {
        item.roles.forEach(role => {
          const pill = document.createElement('span');
          pill.className = 'role-pill';
          pill.textContent = role;
          els.mRoles.appendChild(pill);
        });
      }

      els.mDesc.textContent = item.desc;
      els.detailModal.classList.add('active');
    }

    function closeDetailModal() {
      els.detailModal.classList.remove('active');
    }

    // 2. Language Modal
    function openLangModal() {
      // Rebuild list to show active state
      els.langList.innerHTML = languages.map(lang => {
        const isActive = lang.code === state.lang;
        return `
                    <button class="lang-btn ${isActive ? 'active' : ''}" onclick="selectLanguage('${lang.code}')">
                        <span>${lang.name}</span>
                        <svg class="check icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                    </button>
                `;
      }).join('');
      els.langModal.classList.add('active');
    }

    function closeLangModal() {
      els.langModal.classList.remove('active');
    }

    // Exposed Global Function for HTML onclick
    window.selectLanguage = (code) => {
      state.lang = code;
      localStorage.setItem('raadddr_lang', state.lang);
      updateContent();
      closeLangModal();
    };

    // --- Theme Logic ---

    function updateTheme() {
      els.html.setAttribute('data-theme', state.theme);
      const d = state.theme === 'dark'
        ? "M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-5.4-5.4c0-1.81.73-3.44 1.91-4.64C12.92 3.04 12.46 3 12 3zm0-2a11 11 0 0111 11 11 11 0 01-11 11A11 11 0 011 12 11 11 0 0112 1z"
        : "M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000 1.41.996.996 0 001.41 0l1.06-1.06c.39-.39.39-1.03 0-1.41s-1.03-.39-1.41 0l-1.06 1.06z";

      els.themeIcon.querySelector('path').setAttribute('d', d);
      updateThemeLabel();
    }

    // --- Event Listeners ---

    // Open Language Modal
    els.langBtn.addEventListener('click', openLangModal);

    // Close Language Modal
    els.closeLangModal.addEventListener('click', closeLangModal);
    els.langModal.addEventListener('click', (e) => {
      if (e.target === els.langModal) closeLangModal();
    });

    // Theme Toggle
    els.themeToggle.addEventListener('click', () => {
      state.theme = state.theme === 'dark' ? 'light' : 'dark';
      localStorage.setItem('raadddr_theme', state.theme);
      updateTheme();
    });

    // Close Detail Modal
    els.closeDetailModal.addEventListener('click', closeDetailModal);
    els.detailModal.addEventListener('click', (e) => {
      if (e.target === els.detailModal) closeDetailModal();
    });

    // Global Escape Key Closes Top Modal
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (els.langModal.classList.contains('active')) {
          closeLangModal();
        } else if (els.detailModal.classList.contains('active')) {
          closeDetailModal();
        }
      }
    });

    // --- Initialization ---
    updateTheme();
    updateContent();

  </script>
</body>

</html>
